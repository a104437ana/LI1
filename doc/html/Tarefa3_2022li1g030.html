<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa3_2022li1g030</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Ana S&#225; Oliveira &lt;a104437@alunos.uminho.pt&gt;<br />Sara Campos Ramalho &lt;a72481@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa3_2022li1g030</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o animaJogo</a><ul><li><a href="#g:2">Fun&#231;&#227;o principal</a></li><li><a href="#g:3">Fun&#231;&#245;es auxiliares</a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 3 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:animaJogo">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:posicaoJogador">posicaoJogador</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>)</li><li class="src short"><a href="#v:animaJogador">animaJogador</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:ordenada">ordenada</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; Int</li><li class="src short"><a href="#v:variacaoDaOrdenada">variacaoDaOrdenada</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; Int</li><li class="src short"><a href="#v:animaMapa">animaMapa</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>) -&gt; Int -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:animaLista">animaLista</a> :: Int -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:movObstaculos">movObstaculos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li><li class="src short"><a href="#v:movCarros">movCarros</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o animaJogo</h1></a><a href="#g:2" id="g:2"><h2>Fun&#231;&#227;o principal</h2></a><div class="top"><p class="src"><a id="v:animaJogo" class="def">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:animaJogo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogo" title="Tarefa3_2022li1g030">animaJogo</a></code>, que recebe um jogo e uma jogada e que retorna um jogo, movimenta os obst&#225;culos, de acordo com a velocidade do terreno em que se encontram, e o personagem, de 
acordo com a jogada dada.</p><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogo" title="Tarefa3_2022li1g030">animaJogo</a></code> pode ser definida em fun&#231;&#227;o de outras fun&#231;&#245;es auxiliares: a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code>, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code> e a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code>. A
fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code> cont&#233;m ainda outra fun&#231;&#227;o auxiliar, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:ordenada" title="Tarefa3_2022li1g030">ordenada</a></code>. A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code> cont&#233;m ainda outra fun&#231;&#227;o auxiliar, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code>, que por sua vez cont&#233;m
duas fun&#231;&#245;es auxiliares, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code> e a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code>.</p><p>Primeiro, aplicamos a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, ou seja, primeiro, movimentamos o jogador de acordo com a jogada dada, no mapa inicial. Depois, aplicamos outras fun&#231;&#245;es que analisam a
situa&#231;&#227;o do jogo, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code> e a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code>, cujos resultados ser&#227;o usados na fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code>. Por fim, aplicamos a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code>, ou seja, no final,
movimentamos o &quot;mapa&quot;, mais especificamente os obst&#225;culos, de acordo com a velocidade do terreno em que se encontram.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogo" title="Tarefa3_2022li1g030">animaJogo</a></code> pode ser definida da seguinte forma:</p><pre>animaJogo j jo = animaMapa (animaJogador j jo) (posicaoJogador j) (variacaoDaOrdenada j jo)
</pre></div></div><a href="#g:3" id="g:3"><h2>Fun&#231;&#245;es auxiliares</h2></a><div class="top"><p class="src"><a id="v:posicaoJogador" class="def">posicaoJogador</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>) <a href="#v:posicaoJogador" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code>, que recebe um jogo e retorna um par de terreno e de obst&#225;culo, pega num jogo e calcula o terreno e o obst&#225;culo onde o jogador se encontra naquele jogo.</p><p>Consideremos (x,y) as coordenadas do jogador e l a lista do mapa. Primeiro, obtemos o par de terreno e de lista de obst&#225;culos em que o jogador se encontra, calculando (l !! y). Depois, 
obtemos o primeiro elemento deste par, calculando (fst (l !! y)), ou seja, obtemos o terreno em que o jogador se encontra. Depois, obtemos o segundo elemento do par, calculando 
(snd (l !! y)), ou seja, obtemos a lista de obst&#225;culos ou a linha em que o jogador se encontra, a lista de obst&#225;culos y do mapa ou linha y do mapa. Por fim, calculando 
((snd (l !! y)) !! x), obtemos o obst&#225;culo em que o jogador se encontra, o obst&#225;culo x da linha y ou o elemento x da lista de obst&#225;culos y.</p><p>Como o canto superior esquerdo do mapa representa as coordenadas (0,0) e como todas as posi&#231;&#245;es no mapa tem abcissas e ordenadas n&#227;o negativas (ou seja, positivas ou nulas), ent&#227;o
podemos utilizar a fun&#231;&#227;o (!!) (que apenas trabalha com listas e com n&#250;meros n&#227;o negativos) sem preocupa&#231;&#245;es.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code> pode ser definida da seguinte forma:</p><pre>posicaoJogador (Jogo (Jogador (x,y)) (Mapa _ l)) = (fst (l !! y) , ((snd (l !! y)) !! x))
</pre></div></div><div class="top"><p class="src"><a id="v:animaJogador" class="def">animaJogador</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:animaJogador" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, que recebe um jogo e uma jogada e que retorna um jogo, movimenta um jogador num jogo. </p><p>Se a jogada for Parado ent&#227;o o jogo que retorna ser&#225; o mesmo que recebeu, uma vez que o jogador n&#227;o se moveu.</p><p>As jogadas Move Cima, Move Baixo, etc. fazem com que o jogador se mova 1 unidade para cima, baixo, etc, respectivamente. Se a jogada for Move Cima ent&#227;o a ordenada do jogador passar&#225; de y 
para y-1. Se a jogada for Move Baixo ent&#227;o a ordenada do jogador passar&#225; de y para y+1. Se a jogada for Move Esquerda ent&#227;o a abcissa do jogador passar&#225; de x para x-1. Se a jogada for Move
Direita ent&#227;o a abcissa do jogador passar&#225; de x para x+1. Isto acontece porque o canto superior esquerdo do mapa representa as coordenadas (0,0) e porque todas as posi&#231;&#245;es no mapa tem 
abcissas e ordenadas n&#227;o negativas (ou seja, positivas ou nulas).</p><p>No entanto, temos que ter em aten&#231;&#227;o que o jogador n&#227;o consegue escapar do mapa atrav&#233;s dos seus movimentos. Por exemplo, se o jogador se encontrar na linha de topo do mapa, ent&#227;o mover-se
para cima n&#227;o tem qualquer efeito, uma vez que j&#225; se encontra no limite do mapa. Assim, quando y for igual a 0 e quando a jogada for Move Cima, o jogador n&#227;o altera a sua posi&#231;&#227;o. Seguindo
o mesmo racioc&#237;nio, quando x for igual a 0 e a quando a jogada for Move Esquerda, o jogador n&#227;o altera a sua posi&#231;&#227;o. Quando x for igual &#225; largura do mapa menos uma unidade (porque 
come&#231;amos a contar do 0) e quando a jogada for Move Direita, o jogador n&#227;o altera a sua posi&#231;&#227;o. Quando o y for igual ao comprimento da lista total do mapa menos uma unidade (porque
come&#231;amos a contar do 0) e quando a jogada for Move Baixo, o jogador n&#227;o altera a sua posi&#231;&#227;o.</p><p>Por fim, ainda temos de ter em aten&#231;&#227;o que o jogador n&#227;o ocupa posi&#231;&#245;es onde existem Arvores. Ou seja, quando o jogador vai em dire&#231;&#227;o a uma Arvore, ele acaba por se manter na mesma 
posi&#231;&#227;o, uma vez que n&#227;o pode ocupar a posi&#231;&#227;o de uma Arvore. Assim, se uma Arvore se encontrar, por exemplo, em baixo do jogador, ou seja se 
posicaoJogador (Jogo (Jogador (x,y+1)) (Mapa n l)) resultar em (Relva,Arvore) e se a jogada for Move Baixo, ent&#227;o o jogador n&#227;o se ir&#225; mecher. Isto tamb&#233;m acontece quando tem uma Arvore em
cima, &#224; direita ou &#224; esquerda do jogador e quando a jogada &#233; respetivamente, Move Cima, Move Direita e Move Esquerda.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code> pode ser definida da seguinte forma:</p><pre>animaJogador (Jogo (Jogador (x,y)) (Mapa n l)) j = 
    case j of (Parado) -&gt; jo

              (Move Cima) | y == 0 -&gt; jo
                          | posicaoJogador (Jogo (Jogador (x,y-1)) m) == (Relva,Arvore) -&gt; jo
                          | otherwise -&gt; (Jogo (Jogador (x,y-1)) m)

              (Move Baixo) | y == (length l) - 1 -&gt; jo
                           | posicaoJogador (Jogo (Jogador (x,y+1)) m) == (Relva,Arvore) -&gt; jo
                           | otherwise -&gt; (Jogo (Jogador (x,y+1)) m)

              (Move Esquerda) | x == 0 -&gt; jo
                              | posicaoJogador (Jogo (Jogador (x-1,y)) m) == (Relva,Arvore) -&gt; jo
                              | otherwise -&gt; (Jogo (Jogador (x-1,y)) m)

              (Move Direita) | x == (n-1) -&gt; jo
                             | posicaoJogador (Jogo (Jogador (x+1,y)) m) == (Relva,Arvore) -&gt; jo
                             | otherwise -&gt; (Jogo (Jogador (x+1,y)) m)

     where jo = (Jogo (Jogador (x,y)) (Mapa n l))
           m = (Mapa n l)
</pre></div></div><div class="top"><p class="src"><a id="v:ordenada" class="def">ordenada</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; Int <a href="#v:ordenada" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:ordenada" title="Tarefa3_2022li1g030">ordenada</a></code>, que recebe um jogo e retorna um n&#250;mero inteiro, descobre qual &#233; a ordenada de um jogador num determinado jogo.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:ordenada" title="Tarefa3_2022li1g030">ordenada</a></code> pode ser definida da seguinte forma:</p><pre>ordenada (Jogo (Jogador (_,y)) (Mapa _ _)) = y
</pre></div></div><div class="top"><p class="src"><a id="v:variacaoDaOrdenada" class="def">variacaoDaOrdenada</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; Int <a href="#v:variacaoDaOrdenada" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code>, que recebe um jogo e uma jogada e que retorna um n&#250;mero inteiro, calcula a varia&#231;&#227;o da ordenada do jogador desde antes da jogada ser dada at&#233; depois da 
jogada ser aplicada. Calcula a diferen&#231;a entre a ordenada inicial do jogador e a ordenada final do jogador ap&#243;s ser aplicada a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code> (ap&#243;s o jogador se movimentar). Para 
calcular as ordenadas do jogador de cada jogo, jogo inicial e jogo ap&#243;s a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, usamos a fun&#231;&#227;o anterior, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:ordenada" title="Tarefa3_2022li1g030">ordenada</a></code>. Para calcular o jogo ap&#243;s a fun&#231;&#227;o 
<code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, usamos presisamente e obviamente a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code> pode ser definida da seguinte forma:</p><pre>variacaoDaOrdenada j jo = ordenada j - ordenada (animaJogador j jo)
</pre></div></div><div class="top"><p class="src"><a id="v:animaMapa" class="def">animaMapa</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>) -&gt; Int -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:animaMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code>, que recebe um jogo, um par de terreno e de obst&#225;culo e um n&#250;mero inteiro e que retorna um jogo, anima o mapa e tamb&#233;m anima o jogador em algumas ocasi&#245;es (quando
o jogador acompanha o movimento do tronco).</p><p>Se o par de terreno e de obst&#225;culo resultante da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code> aplicada ao jogo for (Rio v, Tronco) ent&#227;o o jogador inicialmente, antes de se mover, se encontrava num Rio e num 
Tronco.</p><p>Se o n&#250;mero inteiro resultante da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code> aplicada ao jogo e a jogada for 0 ent&#227;o isto significa que a ordenada do jogador, o y do jogador n&#227;o se alterou, ap&#243;s a
aplica&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaJogador" title="Tarefa3_2022li1g030">animaJogador</a></code>, ou seja, o jogador ou se moveu horizontalmente, ou ficou parado. Assim, o jogador n&#227;o se moveu verticalmente.</p><p>Se o jogador se encontrava inicialmente num Rio e num Tronco e se n&#227;o se moveu verticalmente ent&#227;o o jogador ir&#225; acompanhar o movimento do tronco em que se encontrava inicialmente. Assim, 
&#224; abcissa do jogador iremos adicionar a velocidade do rio onde o jogador se encontra, para assim, o jogador acompanhar o movimento do tronco (o movimento do rio). Para al&#233;m de animar o
jogador, tamb&#233;m iremos animar o mapa, mais precisamente, a lista do mapa. Para isso, iremos usar a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code>, que ir&#225; ser definida posteriormente.</p><p>Caso o par de terreno e de obst&#225;culo resultante da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:posicaoJogador" title="Tarefa3_2022li1g030">posicaoJogador</a></code> aplicada ao jogo n&#227;o for (Rio v, Tronco) ou o n&#250;mero inteiro resultante da fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:variacaoDaOrdenada" title="Tarefa3_2022li1g030">variacaoDaOrdenada</a></code> aplicada 
ao jogo e a jogada n&#227;o for 0 ou ambos, ent&#227;o n&#227;o precisamos de animar o jogador, uma vez que este n&#227;o ir&#225; acompanhar o movimento do tronco. Neste caso, apenas presisamos de animar o mapa,
mais precisamente, a lista do mapa e para isso voltaremos a usar a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaMapa" title="Tarefa3_2022li1g030">animaMapa</a></code> pode ser definida da seguinte forma:</p><pre>animaMapa (Jogo (Jogador (x,y)) (Mapa n l)) (Rio v,Tronco) 0 = (Jogo (Jogador (x+v,y)) (Mapa n (animaLista x y l)))
animaMapa (Jogo (Jogador (x,y)) (Mapa n l)) _ _ = (Jogo (Jogador (x,y)) (Mapa n (animaLista x y l)))
</pre></div></div><div class="top"><p class="src"><a id="v:animaLista" class="def">animaLista</a> :: Int -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:animaLista" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code>, que recebe dois n&#250;meros inteiros (a abcissa e a ordenada do jogador) e uma lista de pares de terreno e de lista de obst&#225;culos e que retorna uma lista de pares de
terreno e de lista de obst&#225;culos, anima a lista do mapa.</p><p>A abcissa do jogador n&#227;o &#233; diretamente usada nesta fun&#231;&#227;o. No entanto, temos que mante-la nesta fun&#231;&#227;o porque caso seja necess&#225;rio utilizar a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> para animar uma linha do
mapa, ent&#227;o a&#237;, na fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> iremos necessitar da abcissa do jogador.</p><p>A ordenada do jogador &#233; diretamente usada nesta fun&#231;&#227;o. Se esta for 0 e se a cabe&#231;a da lista do mapa for uma linha de Estrada, ent&#227;o o jogador encontra-se numa Estrada, logo pode ser
poss&#237;velmente atropelado. Tendo em conta o poss&#237;vel atropelamento, iremos usar uma fun&#231;&#227;o especial, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code>, que move os obst&#225;culos das estradas (os carros) a pensar num 
poss&#237;vel atropelamento. </p><p>Para isto acontecer, o jogador n&#227;o necessita de estar obrigatoriamente na primeira linha do mapa (linha 0) que &#233; uma estrada. Na verdade, o jogador apenas necessita de se encontrar numa
estrada. Isto acontece porque ap&#243;s animarmos uma linha, aplicamos a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code> &#224; abcissa do jogador, &#224; ordenada do jogador menos uma unidade e ao resto da lista do mapa. Assim,
ao retirar sempre uma unidade ao valor da ordenada do jogador, iremos eventualmente chegar ao 0 e nesse momento sabemos que a cabe&#231;a da lista do mapa &#233; a linha onde o jogador se encontra.
Se essa linha for estrada, aplicamos a tal fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code>.</p><p>Para os outros casos, a ordenada &#233; completamente desnecess&#225;ria, no entanto temos de manter a ordenada para garantir que no caso de o jogador se encontrar numa estrada (ordenada &#233; 0) esta
linha ser&#225; animada pela fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> e n&#227;o pela fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code> (fun&#231;&#227;o mais geral mas que ignora um poss&#237;vel atropelamento e que tamb&#233;m &#233; usada em estradas).</p><p>Se a fun&#231;&#227;o receber uma lista vazia ir&#225; retornar lista vazia, pois n&#227;o existem obst&#225;culos que se podem mover (a lista vazia n&#227;o tem elementos logo n&#227;o tem obst&#225;culos).</p><p>Se a fun&#231;&#227;o receber uma lista cuja a cabe&#231;a seja uma linha de Relva, ent&#227;o como numa relva n&#227;o existe velocidade e os obst&#225;culos n&#227;o se movimentam ent&#227;o a fun&#231;&#227;o ir&#225; retornar a linha de
Relva inalterada e ir&#225; aplicar a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code> ao resto da lista (recursividade).</p><p>Se a fun&#231;&#227;o receber uma lista cuja cabe&#231;a seja uma linha de Rio ou uma linha de Estrada (e a ordenada seja diferente de 0 neste &#250;ltimo caso) ent&#227;o iremos aplicar a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code>
para obter as listas de obst&#225;culos dos rios e das estradas, e para o resto da lista do mapa aplicamos a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code> (recursividade).</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:animaLista" title="Tarefa3_2022li1g030">animaLista</a></code> pode ser definida da seguinte forma:</p><pre>animaLista _ _ [] = []
animaLista x 0 ((Estrada v,l):t) = [movCarros x v (Estrada v,l)] ++ (animaLista x (-1) t)
animaLista x y ((Estrada v,l):t) = [movObstaculos v (Estrada v,l)] ++ (animaLista x (y-1) t)
animaLista x y ((Rio v,l):t) = [movObstaculos v (Rio v,l)] ++ (animaLista x (y-1) t)
animaLista x y ((Relva,l):t) = [(Relva,l)] ++ (animaLista x (y-1) t)
</pre></div></div><div class="top"><p class="src"><a id="v:movObstaculos" class="def">movObstaculos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) <a href="#v:movObstaculos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code>, que recebe um inteiro (a velocidade do terreno) e um par de terreno e de lista de obst&#225;culos e que retorna um par de terreno e de lista de obst&#225;culos, 
movimenta os obst&#225;culos de um rio ou estrada de acordo com a velocidade do terreno. </p><p>Numa estrada ou rio com velocidade v, os obst&#225;culos devem mover-se |v| unidades na dire&#231;&#227;o determinada. Se a velocidade v for igual a 0, os obst&#225;culos n&#227;o se movimentam, ou seja, a fun&#231;&#227;o
ir&#225; retornar a mesma lista que recebeu, porque nada se alterou. </p><p>Se a velocidade v for positiva, os obst&#225;culos movem-se |v| unidades da esquerda para a direita. Se a velocidade v for negativa, os obst&#225;culos movem-se |v| unidades da direita para a 
esquerda. </p><p>Sabemos que ao deslocar os obst&#225;culos de uma linha, estes desaparecerem por um dos lados do mapa e devem reaparecer no lado oposto. Assim, para mover os obst&#225;culos apenas temos de mudar a 
ordem da lista de obst&#225;culos. </p><p>Quando a lista de obst&#225;culos se move para a direita, quando a velocidade v &#233; positiva, pegamos nos ult&#237;mos v elementos da lista e os colocamos na frente da lista. Para fazer isto podemos 
usar as fun&#231;&#245;es last, init e (++) pr&#233;-definidas no Haskell. </p><p>Quando a lista de obst&#225;culos se move para a esquerda, quando a velocidade v &#233; negativa, pegamos nos primeiros v elementos da lista e os colocamos atr&#225;s da lista. Para fazer isto podemos 
usar as fun&#231;&#245;es head, tail e (++) pr&#233;-definidas no Haskell.</p><p>Para os obst&#225;culos n&#227;o se moverem infinitamente e pararem, ent&#227;o sempre que aplicamos a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code> para al&#233;m de alterarmos a ordem dos obst&#225;culos tamb&#233;m retiramos uma unidade
a velocidade do terreno se esta for positiva ou adicionamos uma unidade a velocidade do terreno se esta for negativa. Assim, ao aplicar esta fun&#231;&#227;o, eventualmente a velocidade ir&#225; ser 0,
e nesse momento a fun&#231;&#227;o ir&#225; retornar o par de terreno e de lista de obst&#225;culos que recebeu. Quando a velocidade for 0, significa que os obst&#225;culos j&#225; se moveram o quanto deviam mover
segundo a velocidade inicial do terreno.</p><p>Assim, a fun&#231;&#227;o recursiva <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code> pode ser definida da seguinte forma:</p><pre>movObstaculos n p = case p of (Rio v, []) -&gt; (Rio v, [])
                              (Estrada v,[]) -&gt; (Estrada v, [])
                              (Rio v,l) | n==0 -&gt; (Rio v,l)
                                        | n&gt;0 -&gt; movObstaculos (n-1) (Rio v,[last l] ++ (init l))
                                        | n<a href="0">-</a> movObstaculos (n+1) (Rio v,(tail l) ++ [head l])
                              (Estrada v,l) | n==0 -&gt; (Estrada v,l)
                                            | n&gt;0 -&gt; movObstaculos (n-1) (Estrada v,[last l] ++ (init l))
                                            | n<a href="0">-</a> movObstaculos (n+1) (Estrada v,(tail l) ++ [head l])
</pre></div></div><div class="top"><p class="src"><a id="v:movCarros" class="def">movCarros</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) <a href="#v:movCarros" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code>, que recebe dois inteiros (a abcissa do jogador e a velocidade da estrada) e um par de terreno e de lista de obst&#225;culos e retorna um par de terreno e de lista de
obst&#225;culos, anima os obst&#225;culos de uma estrada (os carros) tendo em conta um poss&#237;vel atropelamento.</p><p>Se a lista de obst&#225;culos for vazia, a fun&#231;&#227;o retorna um par de terreno estrada com uma determinada velocidade e de uma lista vazia (uma vez que a lista vazia n&#227;o tem elementos logo n&#227;o tem
obst&#225;culos, logo estes n&#227;o se podem mover).</p><p>Se o obst&#225;culo n&#250;mero x (a abcissa do jogador) da lista de obst&#225;culos for um Carro (come&#231;ando a contar a partir do 0), ou seja, se (l !! x) == Carro ent&#227;o o jogador encontra-se na posi&#231;&#227;o
de um carro, logo foi atropelado. Nesta situa&#231;&#227;o, a fun&#231;&#227;o devolve a linha do mapa inalterada uma vez que o movimento do obst&#225;culo Carro &#769;e interrompido ao atropelar o jogador. Na verdade,
o movimento de toda a linha, de todos os obst&#225;culos da linha &#233; interrompido quando um carro atropela o jogador.</p><p>Nos outros casos, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> haje da mesma forma que a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movObstaculos" title="Tarefa3_2022li1g030">movObstaculos</a></code> com a diferen&#231;a que a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> continua a usar a abcissa do jogador, pois eventualmente a
posi&#231;&#227;o do jogador pode coincidir com a posi&#231;&#227;o do carro e a&#237; a fun&#231;&#227;o iria ter que retornar a linha do mapa que recebeu.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa3_2022li1g030.html#v:movCarros" title="Tarefa3_2022li1g030">movCarros</a></code> pode ser definida da seguinte forma:</p><pre>movCarros x n (Estrada v,l) | l == [] = (Estrada v, [])
                            | (l !! x) == Carro = (Estrada v,l)
                            | n==0 = (Estrada v,l)
                            | n&gt;0 = movCarros x (n-1) (Estrada v,[last l] ++ (init l))
                            | n&lt;0 = movCarros x (n+1) (Estrada v,(tail l) ++ [head l])
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>