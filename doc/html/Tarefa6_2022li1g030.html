<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa6_2022li1g030</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Ana S&#225; Oliveira &lt;a104437@alunos.uminho.pt&gt;<br />Sara Campos Ramalho &lt;a72481'alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Tarefa6_2022li1g030</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 6 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:OpcaoMenuInicial">OpcaoMenuInicial</a><ul class="subs"><li>= <a href="#v:NovoJogo">NovoJogo</a></li><li>| <a href="#v:Continuar">Continuar</a></li><li>| <a href="#v:Sair">Sair</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:OpcaoMenuPausa">OpcaoMenuPausa</a><ul class="subs"><li>= <a href="#v:Retomar">Retomar</a></li><li>| <a href="#v:Gravar">Gravar</a></li><li>| <a href="#v:Gravado">Gravado</a></li><li>| <a href="#v:VoltarMenuInicial">VoltarMenuInicial</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:EstadoAtual">EstadoAtual</a><ul class="subs"><li>= <a href="#v:MenuInicial">MenuInicial</a> <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></li><li>| <a href="#v:MenuPausa">MenuPausa</a> <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></li><li>| <a href="#v:ModoJogo">ModoJogo</a></li><li>| <a href="#v:PerdeuJogo">PerdeuJogo</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Seed">Seed</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Pontuacao">Pontuacao</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:LinhaAtual">LinhaAtual</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:TempoDecorrido">TempoDecorrido</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Imagens">Imagens</a> = [Picture]</li><li class="src short"><span class="keyword">type</span> <a href="#t:World">World</a> = (<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>, [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>], <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a>, <a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a>, <a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a>, <a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a>, <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:SaveData">SaveData</a> = (<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>, [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>], <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a>, <a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a>, <a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a>, <a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a>)</li><li class="src short"><a href="#v:janela">janela</a> :: Display</li><li class="src short"><a href="#v:estadoInicial">estadoInicial</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>] -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:estendeAte">estendeAte</a> :: Int -&gt; [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>] -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:desenhaIO">desenhaIO</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO Picture</li><li class="src short"><a href="#v:desenhaMapa">desenhaMapa</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaTerreno">desenhaTerreno</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaObstaculo">desenhaObstaculo</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaCarrosDireita">desenhaCarrosDireita</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaCarrosEsquerda">desenhaCarrosEsquerda</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaTroncosDireita">desenhaTroncosDireita</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaTroncosEsquerda">desenhaTroncosEsquerda</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaJogador">desenhaJogador</a> :: Int -&gt; Int -&gt; [Picture]</li><li class="src short"><a href="#v:eventoIO">eventoIO</a> :: Event -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:tempoIO">tempoIO</a> :: Float -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:tempo">tempo</a> :: Float -&gt; Int -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:converteWorldParaSaveData">converteWorldParaSaveData</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a></li><li class="src short"><a href="#v:guardaJogo">guardaJogo</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:converteSaveDataParaWorld">converteSaveDataParaWorld</a> :: <a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:carregaJogo">carregaJogo</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:removeJogoGuardado">removeJogoGuardado</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></li><li class="src short"><a href="#v:verdeRelva">verdeRelva</a> :: Color</li><li class="src short"><a href="#v:cinzaEstrada">cinzaEstrada</a> :: Color</li><li class="src short"><a href="#v:azulRio">azulRio</a> :: Color</li><li class="src short"><a href="#v:castanhoTronco">castanhoTronco</a> :: Color</li><li class="src short"><a href="#v:castanhoTroncoClaro">castanhoTroncoClaro</a> :: Color</li><li class="src short"><a href="#v:fundo">fundo</a> :: Picture</li><li class="src short"><a href="#v:fundoPerdeu">fundoPerdeu</a> :: Picture</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OpcaoMenuInicial" class="def">OpcaoMenuInicial</a> <a href="#t:OpcaoMenuInicial" class="selflink">#</a></p><div class="doc"><p>O tipo de dados <code><a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></code> representa as diferentes op&#231;&#245;es apresentadas no menu inicial do jogo: 
        <code><a href="Tarefa6_2022li1g030.html#v:NovoJogo" title="Tarefa6_2022li1g030">NovoJogo</a></code>, para iniciar um novo jogo, 
        <code><a href="Tarefa6_2022li1g030.html#v:Continuar" title="Tarefa6_2022li1g030">Continuar</a></code>, para carregar um jovo previamente guardado, e 
        <code><a href="Tarefa6_2022li1g030.html#v:Sair" title="Tarefa6_2022li1g030">Sair</a></code>, para sair do jogo e fechar a janela.</p><pre>data OpcaoMenuInicial = NovoJogo
                      | Continuar
                      | Sair
    deriving (Show, Read)
</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NovoJogo" class="def">NovoJogo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Continuar" class="def">Continuar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Sair" class="def">Sair</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OpcaoMenuInicial">Instances</h4><details id="i:OpcaoMenuInicial" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OpcaoMenuInicial:Read:1"></span> Read <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></span> <a href="#t:OpcaoMenuInicial" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OpcaoMenuInicial:Read:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OpcaoMenuInicial:Show:2"></span> Show <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></span> <a href="#t:OpcaoMenuInicial" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OpcaoMenuInicial:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OpcaoMenuPausa" class="def">OpcaoMenuPausa</a> <a href="#t:OpcaoMenuPausa" class="selflink">#</a></p><div class="doc"><p>O tipo de dados <code><a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></code> representa as op&#231;&#245;es dispon&#237;veis no menu de pausa do jogo: 
        <code><a href="Tarefa6_2022li1g030.html#v:Retomar" title="Tarefa6_2022li1g030">Retomar</a></code>, para sair do menu de pausa e voltar ao mapa do jogo
        <code><a href="Tarefa6_2022li1g030.html#v:Gravar" title="Tarefa6_2022li1g030">Gravar</a></code>, para guardar num ficheiro o progresso feito no mapa
        <code><a href="Tarefa6_2022li1g030.html#v:Gravado" title="Tarefa6_2022li1g030">Gravado</a></code>, para confirmar que foi de facto guardado o progresso do jogo</p><pre>data OpcaoMenuPausa = Retomar
                    | Gravar
                    | Gravado
                    | VoltarMenuInicial
    deriving (Show, Read)
</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Retomar" class="def">Retomar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Gravar" class="def">Gravar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Gravado" class="def">Gravado</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:VoltarMenuInicial" class="def">VoltarMenuInicial</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OpcaoMenuPausa">Instances</h4><details id="i:OpcaoMenuPausa" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OpcaoMenuPausa:Read:1"></span> Read <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></span> <a href="#t:OpcaoMenuPausa" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OpcaoMenuPausa:Read:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OpcaoMenuPausa:Show:2"></span> Show <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></span> <a href="#t:OpcaoMenuPausa" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OpcaoMenuPausa:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EstadoAtual" class="def">EstadoAtual</a> <a href="#t:EstadoAtual" class="selflink">#</a></p><div class="doc"><p>O tipo de dados EstadoAtual representa os diferentes estados em que o jogo pode estar: 
        <code><a href="Tarefa6_2022li1g030.html#v:MenuInicial" title="Tarefa6_2022li1g030">MenuInicial</a></code>, correspondente ao menu inicial
        <code><a href="Tarefa6_2022li1g030.html#v:MenuPausa" title="Tarefa6_2022li1g030">MenuPausa</a></code>, correspondente ao menu de pausa
        <code><a href="Tarefa6_2022li1g030.html#v:ModoJogo" title="Tarefa6_2022li1g030">ModoJogo</a></code>, correspondente ao modo de jogo, em que o jogador percorre o mapa
        <code><a href="Tarefa6_2022li1g030.html#v:PerdeuJogo" title="Tarefa6_2022li1g030">PerdeuJogo</a></code>, correspondente ao fim de um jogo por ter perdido</p><pre>data EstadoAtual = MenuInicial OpcaoMenuInicial
                 | MenuPausa OpcaoMenuPausa
                 | ModoJogo
                 | PerdeuJogo
    deriving (Show, Read)
</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MenuInicial" class="def">MenuInicial</a> <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuInicial" title="Tarefa6_2022li1g030">OpcaoMenuInicial</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:MenuPausa" class="def">MenuPausa</a> <a href="Tarefa6_2022li1g030.html#t:OpcaoMenuPausa" title="Tarefa6_2022li1g030">OpcaoMenuPausa</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ModoJogo" class="def">ModoJogo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PerdeuJogo" class="def">PerdeuJogo</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:EstadoAtual">Instances</h4><details id="i:EstadoAtual" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:EstadoAtual:Read:1"></span> Read <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a></span> <a href="#t:EstadoAtual" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:EstadoAtual:Read:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:EstadoAtual:Show:2"></span> Show <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a></span> <a href="#t:EstadoAtual" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:EstadoAtual:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g030.html">Tarefa6_2022li1g030</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Seed" class="def">Seed</a> = Int <a href="#t:Seed" class="selflink">#</a></p><div class="doc"><p>Os tipos de dados <code><a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a></code> e <code><a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a></code> correspondem, respetivamente: 
&#224; seed usada para atribuir aleatoriedade ao mapa, &#224; pontua&#231;&#227;o atingida pelo jogador, &#224; linha do mapa em que o jogador se encontra no momento, ao tempo decorrido desde o in&#237;cio do jogo e ao conjunto de <code>Pictures</code>.</p><pre>type Seed = Int
type Pontuacao = Int
type LinhaAtual = Int
type TempoDecorrido = Int
type Imagens = [Picture]
</pre></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Pontuacao" class="def">Pontuacao</a> = Int <a href="#t:Pontuacao" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:LinhaAtual" class="def">LinhaAtual</a> = Int <a href="#t:LinhaAtual" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TempoDecorrido" class="def">TempoDecorrido</a> = Int <a href="#t:TempoDecorrido" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Imagens" class="def">Imagens</a> = [Picture] <a href="#t:Imagens" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:World" class="def">World</a> = (<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>, [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>], <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a>, <a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a>, <a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a>, <a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a>, <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a>) <a href="#t:World" class="selflink">#</a></p><div class="doc"><p>O tipo de dados <code><a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></code> junta <code><a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a></code>, '[Seed]', <code><a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a></code>, <code><a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a></code> e <code><a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a></code> para englobar todos os elementos que v&#227;o constituir o jogo.</p><pre>type World = (EstadoAtual, [Seed], Jogo, LinhaAtual, Pontuacao, TempoDecorrido, Imagens)
</pre></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:SaveData" class="def">SaveData</a> = (<a href="Tarefa6_2022li1g030.html#t:EstadoAtual" title="Tarefa6_2022li1g030">EstadoAtual</a>, [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>], <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a>, <a href="Tarefa6_2022li1g030.html#t:LinhaAtual" title="Tarefa6_2022li1g030">LinhaAtual</a>, <a href="Tarefa6_2022li1g030.html#t:Pontuacao" title="Tarefa6_2022li1g030">Pontuacao</a>, <a href="Tarefa6_2022li1g030.html#t:TempoDecorrido" title="Tarefa6_2022li1g030">TempoDecorrido</a>) <a href="#t:SaveData" class="selflink">#</a></p><div class="doc"><p>O tipo de dados <code><a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a></code> &#233; constitu&#237;do pelos elementos que ser&#227;o usados para criar o ficheiro para guardar o progresso no jogo.</p><pre>type SaveData = (EstadoAtual, [Seed], Jogo, LinhaAtual, Pontuacao, TempoDecorrido)
</pre></div></div><div class="top"><p class="src"><a id="v:janela" class="def">janela</a> :: Display <a href="#v:janela" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:janela" title="Tarefa6_2022li1g030">janela</a></code> disponibiliza a janela onde ser&#225; visualizado o jogo, com o tamanho de 1600 x 900 e posi&#231;&#227;o no ecr&#227; (0,0).</p><pre>janela :: Display
janela = InWindow &quot;Crossy Road&quot; (1600,900) (0,0)
</pre></div></div><div class="top"><p class="src"><a id="v:estadoInicial" class="def">estadoInicial</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>] -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:estadoInicial" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:estadoInicial" title="Tarefa6_2022li1g030">estadoInicial</a></code>, juntamente com a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:estendeAte" title="Tarefa6_2022li1g030">estendeAte</a></code> devolve o estado inicial do jogo, em que se apresenta o menu inicial com a op&#231;&#227;o de novo jogo selecionada, e o mapa inicial j&#225; preparado para ser jogado.</p><pre>estadoInicial :: Imagens -&gt; [Seed] -&gt; World
estadoInicial imagens ls = (MenuInicial NovoJogo, ls, (Jogo (Jogador (8,5)) (estendeAte 5 ls (Mapa 16 [(Relva,[Arvore,Nenhum,Nenhum,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Nenhum,Nenhum,Arvore]),
                                                                                                      (Relva,[Arvore,Arvore,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Arvore,Arvore]),
                                                                                                      (Relva,[Arvore,Nenhum,Arvore,Arvore,Arvore,Arvore,Nenhum,Nenhum,Nenhum,Arvore,Arvore,Arvore,Arvore,Arvore,Nenhum,Nenhum]),
                                                                                                      (Relva,[Arvore,Arvore,Arvore,Arvore,Nenhum,Arvore,Arvore,Nenhum,Nenhum,Nenhum,Arvore,Nenhum,Arvore,Arvore,Arvore,Arvore])]))), 0, 0, 0, imagens)
</pre></div></div><div class="top"><p class="src"><a id="v:estendeAte" class="def">estendeAte</a> :: Int -&gt; [<a href="Tarefa6_2022li1g030.html#t:Seed" title="Tarefa6_2022li1g030">Seed</a>] -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeAte" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:estendeAte" title="Tarefa6_2022li1g030">estendeAte</a></code> &#233; utilizada na fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:estadoInicial" title="Tarefa6_2022li1g030">estadoInicial</a></code> para criar aleatoriamente as restantes 5 linhas do mapa inicial.</p><pre>estendeAte :: Int -&gt; [Seed] -&gt; Mapa -&gt; Mapa
estendeAte 1 (s:ls) m = estendeMapa m s
estendeAte n (s:ls) m = estendeAte (n-1) ls (estendeMapa m s)  
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaIO" class="def">desenhaIO</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO Picture <a href="#v:desenhaIO" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaIO" title="Tarefa6_2022li1g030">desenhaIO</a></code>, juntamente com as fun&#231;&#245;es auxiliares <code><a href="Tarefa6_2022li1g030.html#v:desenhaMapa" title="Tarefa6_2022li1g030">desenhaMapa</a></code>, <code><a href="Tarefa6_2022li1g030.html#v:desenhaTerreno" title="Tarefa6_2022li1g030">desenhaTerreno</a></code>, <code><a href="Tarefa6_2022li1g030.html#v:desenhaObstaculo" title="Tarefa6_2022li1g030">desenhaObstaculo</a></code> e <code><a href="Tarefa6_2022li1g030.html#v:desenhaJogador" title="Tarefa6_2022li1g030">desenhaJogador</a></code>, recebe os mundos poss&#237;veis, dependendo dos estados do 'data EstadoAtual', e desenha os elementos correspondentes apresentados na janela do jogo.</p><pre>desenhaIO :: World -&gt; IO Picture
desenhaIO (MenuInicial NovoJogo, _, _, _, _, _, i) = return $ Pictures [fundo,translate 0 (250) (i !! 1), translate 0 50 (i !! 3),translate 0 (-75) (i !! 4),translate 0 (-200) (i !! 6)]
desenhaIO (MenuInicial Continuar, _, _, _, _, _, i) = return $ Pictures [fundo, translate 0 (250) (i !! 1), translate 0 50 (i !! 2),translate 0 (-75) (i !! 5),translate 0 (-200) (i !! 6)]
desenhaIO (MenuInicial Sair, _, _, _, _, _, i) = return $ Pictures [fundo, translate 0 (250) (i !! 1),translate 0 50 (i !! 2),translate 0 (-75) (i !! 4),translate 0 (-200) (i !! 7)]
desenhaIO (ModoJogo, _, Jogo (Jogador (x,y)) (Mapa 16 l), _, p, td, i) = return $ 
    if jogoTerminou (Jogo (Jogador (x,y)) (Mapa 16 l)) then Pictures ((desenhaMapa i 0 (Mapa 16 l)) ++ [translate (-800) (330) (color white (text (show p)))])
    else Pictures ([Pictures ((desenhaMapa i 0 (Mapa 16 l)) ++ (desenhaJogador x y))] ++ [translate (-800) (330) (color white (text (show p)))])
desenhaIO (MenuPausa Retomar, _, _, _, _, _, i) = return $ Pictures [fundo,translate 0 (250) (i !! 8), translate 0 50 (i !! 10),translate 0 (-75) (i !! 11),translate 0 (-200) (i !! 14)]
desenhaIO (MenuPausa Gravar, _, _, _, _, _, i) = return $ Pictures [fundo,translate 0 (250) (i !! 8), translate 0 50 (i !! 9),translate 0 (-75) (i !! 12),translate 0 (-200) (i !! 14)]
desenhaIO (MenuPausa Gravado, _, _, _, _, _, i) = return $ Pictures [fundo,translate 0 (250) (i !! 8), translate 0 50 (i !! 9),translate 0 (-75) (i !! 13),translate 0 (-200) (i !! 14)]
desenhaIO (MenuPausa VoltarMenuInicial, _, _, _, _, _, i) = return $ Pictures [fundo,translate 0 (250) (i !! 8), translate 0 50 (i !! 9),translate 0 (-75) (i !! 11),translate 0 (-200) (i !! 15)]
desenhaIO (PerdeuJogo, _, _, _, p, _, i) = return $ Pictures ([fundoPerdeu, translate 0 (250) (i !! 16), translate 0 0 (i !! 17), translate (-50) (-200) (i !! 18)] ++ [translate (100) (-250) (color white (text (show p)))])
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaMapa" class="def">desenhaMapa</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [Picture] <a href="#v:desenhaMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaMapa" title="Tarefa6_2022li1g030">desenhaMapa</a></code>, que recebe imagens (lista de pictures), um n&#250;mero e um mapa e que retorna uma lista de pictures, desenha o mapa do jogo do world na tela do computador, na
janela do jogo que aparece no computador. </p><p>Para desenharmos o mapa precisamos das imagens de formato bitmapa, precisamos de um mapa e do n&#250;mero da linha do mapa que iremos come&#231;ar por desenhar (linha 0). Depois iremos desenhar as
outras linhas at&#233; apenas sobrar a lista vazia no mapa: desenhamos o mapa todo logo a fun&#231;&#227;o ir&#225; retornar lista vazia nesse momento.</p><p>Para desenharmos o mapa presisamos de desenhar os terrenos e os obst&#225;culos de cada linha do mapa. Para desenhar os terrenos usamos a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:desenhaTerreno" title="Tarefa6_2022li1g030">desenhaTerreno</a></code> e para desenhar os
obst&#225;culos usamos a fun&#231;&#227;o auxiliar <code>desenhaObstaculos</code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaMapa" title="Tarefa6_2022li1g030">desenhaMapa</a></code> pode ser definida da seguinte forma:</p><pre>desenhaMapa i p (Mapa 16 (h:t)) = (desenhaTerreno i p h) ++ (desenhaObstaculo 0 p h) ++ (desenhaMapa i (p+1) (Mapa 16 t))
desenhaMapa  i p (Mapa 16 []) = []
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaTerreno" class="def">desenhaTerreno</a> :: <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [Picture] <a href="#v:desenhaTerreno" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTerreno" title="Tarefa6_2022li1g030">desenhaTerreno</a></code>, que recebe imagens (lista de pictures), um n&#250;mero e um par de terreno e de lista de obst&#225;culos e que retorna uma lista de pictures, desenha o terreno de uma
linha. </p><p>Para desenharmos o terreno de uma linha presisamos das imagens de formato bitmapa (mais em particular a primeira picture da lista, &quot;estrada&quot;, que representa o terreno Estrada), precisamos
do n&#250;mero da linha do mapa do terreno (para saber onde iremos colocar as pictures na tela do computador) e precisamos do terreno para sabermos se &#233; uma estrada (uma picture), uma relva 
(outra picture) ou um rio (outra picture).</p><p>Assim, para cada terreno apresentamos a picture correspondente que se ir&#225; posicionar no mapa em fun&#231;&#227;o do n&#250;mero da linha. </p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTerreno" title="Tarefa6_2022li1g030">desenhaTerreno</a></code> pode ser definida da seguinte forma:</p><pre>desenhaTerreno i p ter = case ter of Rio _ -&gt; [color azulRio (polygon [((-800),350+(-100)*(fromIntegral p)),((-800),450+(-100)*(fromIntegral p)),(800,450+(-100)*(fromIntegral p)),(800,350+(-100)*(fromIntegral p))])]
                                     Estrada _ -&gt; [translate 0 (400 + (-100)*(fromIntegral p)) (head i)]
                                     Relva -&gt; [color verdeRelva (polygon [((-800),350+(-100)*(fromIntegral p)),((-800),450+(-100)*(fromIntegral p)),(800,450+(-100)*(fromIntegral p)),(800,350+(-100)*(fromIntegral p))])]
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaObstaculo" class="def">desenhaObstaculo</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [Picture] <a href="#v:desenhaObstaculo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaObstaculo" title="Tarefa6_2022li1g030">desenhaObstaculo</a></code>, que recebe dois n&#250;mero (a abcissa e a ordenada do obst&#225;culo) e um par de terreno e de lista de obst&#225;culos e que retorna uma lista de pictures, desenha os
obst&#225;culos de uma linha.</p><p>Se o terreno for Relva, se o primeiro obst&#225;culo for Nenhum n&#227;o ser&#225; adicionada nenhuma picture ([]) e se o primeiro obst&#225;culo for Arvore ser&#225; adicionada uma picture de uma &#225;rvore nas 
coordenadas do obst&#225;culo. Fazemos isto para todos os obst&#225;culos at&#233; a lista dos obst&#225;culos ficar vazia.</p><p>Se o terreno for Estrada e a velocidade for positiva ou nula, ent&#227;o iremos chamar a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosDireita" title="Tarefa6_2022li1g030">desenhaCarrosDireita</a></code> (quando a velocidade &#233; positiva os carros movem-se para a direita
, logo est&#227;o virados para a direita).</p><p>Se o terreno for Estrada e a velocidade for negativa, ent&#227;o iremos chamar a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosEsquerda" title="Tarefa6_2022li1g030">desenhaCarrosEsquerda</a></code> (quando a velocidade &#233; negativa os carros movem-se para a esquerda, logo
est&#227;o virados para a esquerda).</p><p>Se o terreno for Rio e a velocidade for positiva ou nula, ent&#227;o iremos chamar a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosDireita" title="Tarefa6_2022li1g030">desenhaTroncosDireita</a></code> (quando a velocidade &#233; positiva os troncos movem-se para a direita
, logo est&#227;o virados para a direita).</p><p>Se o terreno for Rio e a velocidade for negativa, ent&#227;o iremos chamar a fun&#231;&#227;o auxiliar <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosEsquerda" title="Tarefa6_2022li1g030">desenhaTroncosEsquerda</a></code> (quando a velocidade &#233; negativa os troncos movem-se para a esquerda, logo
est&#227;o virados para a esquerda).</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaObstaculo" title="Tarefa6_2022li1g030">desenhaObstaculo</a></code> pode ser definida da seguinte forma:</p><pre>desenhaObstaculo n1 n2 (Estrada v,(h:t)) | v&gt;=0 = desenhaCarrosDireita h n1 n2 (h:t)
                                         | v&lt;0 = desenhaCarrosEsquerda (last t) n1 n2 (h:t)
desenhaObstaculo n1 n2 (Rio v,(h:t)) | v&gt;=0 = desenhaTroncosDireita h n1 n2 (h:t)
                                     | v&lt;0 = desenhaTroncosEsquerda (last t) n1 n2 (h:t)
desenhaObstaculo n1 n2 (Relva,[]) = []         
desenhaObstaculo n1 n2 (Relva,(h:t)) = case h of Nenhum -&gt; (desenhaObstaculo (n1 + 1) n2 (Relva,t))
                                                 Arvore -&gt; [color (dark (dark green)) (polygon [(((-795)+(100*(fromIntegral n1))),390+(-100)*(fromIntegral n2)),(((-795)+(100)*(fromIntegral n1)),445+(-100)*(fromIntegral n2)),(((-705)+(100*(fromIntegral n1))),445+(-100)*(fromIntegral n2)),(((-705)+(100*(fromIntegral n1))),390+(-100)*(fromIntegral n2))])] ++ [color (dark castanhoTronco) (polygon [(((-780)+(100*(fromIntegral n1))),355+(-100)*(fromIntegral n2)),(((-770)+(100)*(fromIntegral n1)),390+(-100)*(fromIntegral n2)),(((-730)+(100*(fromIntegral n1))),390+(-100)*(fromIntegral n2)),(((-720)+(100*(fromIntegral n1))),355+(-100)*(fromIntegral n2))])] ++ (desenhaObstaculo (n1 + 1) n2 (Relva,t))
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaCarrosDireita" class="def">desenhaCarrosDireita</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture] <a href="#v:desenhaCarrosDireita" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosDireita" title="Tarefa6_2022li1g030">desenhaCarrosDireita</a></code>, que recebe um obst&#225;culo, dois n&#250;meros (abcissa e ordenada do obst&#225;culo) e uma lista de obst&#225;culos e que retorna uma lista de pictures, desenha os 
carros virados para a direita, os carros que se movimentam para a direita.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosDireita" title="Tarefa6_2022li1g030">desenhaCarrosDireita</a></code> pode ser definida da seguinte forma:</p><pre>desenhaCarrosDireita o n1 n2 [] = []
desenhaCarrosDireita o n1 n2 (h:t) = case h of Nenhum -&gt; (desenhaCarrosDireita o (n1 + 1) n2 t)
                                               Carro | t <em>= [] &amp;&amp; head t </em>= Carro -&gt; [color red (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color white (polygon [(((-740)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),430+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),430+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosDireita o (n1 + 1) n2 t)
                                                     | t /= [] &amp;&amp; head t == Carro -&gt; [color (dark blue) (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosDireita o (n1 + 1) n2 t)
                                                     | t == [] &amp;&amp; o /= Carro -&gt; [color red (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color white (polygon [(((-740)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),430+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),430+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosDireita o (n1 + 1) n2 t)
                                                     | t == [] &amp;&amp; o == Carro -&gt; [color (dark blue) (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosDireita o (n1 + 1) n2 t)
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaCarrosEsquerda" class="def">desenhaCarrosEsquerda</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture] <a href="#v:desenhaCarrosEsquerda" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosEsquerda" title="Tarefa6_2022li1g030">desenhaCarrosEsquerda</a></code>, que recebe um obst&#225;culo, dois n&#250;meros (abcissa e ordenada do obst&#225;culo) e uma lista de obst&#225;culos e que retorna uma lista de pictures, desenha os 
carros virados para a esquerda, os carros que se movimentam para a esquerda.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaCarrosEsquerda" title="Tarefa6_2022li1g030">desenhaCarrosEsquerda</a></code> pode ser definida da seguinte forma:</p><pre>desenhaCarrosEsquerda o n1 n2 [] = []
desenhaCarrosEsquerda o n1 n2 (h:t) = case h of Nenhum -&gt; (desenhaCarrosEsquerda h (n1 + 1) n2 t)
                                                Carro | o /= Carro -&gt; [color red (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color white (polygon [(((-790)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),430+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),430+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),400+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosEsquerda h (n1 + 1) n2 t)
                                                      | o == Carro -&gt; [color (dark blue) (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-790)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-760)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ [color black (polygon [(((-740)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2)),(((-740)+(100)*(fromIntegral n1)),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),380+(-100)*(fromIntegral n2)),(((-710)+(100*(fromIntegral n1))),340+(-100)*(fromIntegral n2))])] ++ (desenhaCarrosEsquerda h (n1 + 1) n2 t)
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaTroncosDireita" class="def">desenhaTroncosDireita</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture] <a href="#v:desenhaTroncosDireita" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosDireita" title="Tarefa6_2022li1g030">desenhaTroncosDireita</a></code>, que recebe um obst&#225;culo, dois n&#250;meros (abcissa e ordenada do obst&#225;culo) e uma lista de obst&#225;culos e que retorna uma lista de pictures, desenha os 
troncos virados para a direita, os troncos que se movimentam para a direita.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosDireita" title="Tarefa6_2022li1g030">desenhaTroncosDireita</a></code> pode ser definida da seguinte forma:</p><pre>desenhaTroncosDireita o n1 n2 [] = []
desenhaTroncosDireita o n1 n2 (h:t) = case h of Nenhum -&gt; (desenhaTroncosDireita o (n1 + 1) n2 t)
                                                Tronco | t <em>= [] &amp;&amp; head t </em>= Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color castanhoTroncoClaro (polygon [(((-730)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-730)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosDireita o (n1 + 1) n2 t)
                                                       | t /= [] &amp;&amp; head t == Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosDireita o (n1 + 1) n2 t)
                                                       | t == [] &amp;&amp; o /= Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color castanhoTroncoClaro (polygon [(((-730)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-730)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosDireita o (n1 + 1) n2 t)
                                                       | t == [] &amp;&amp; o == Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosDireita o (n1 + 1) n2 t)
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaTroncosEsquerda" class="def">desenhaTroncosEsquerda</a> :: <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [Picture] <a href="#v:desenhaTroncosEsquerda" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosEsquerda" title="Tarefa6_2022li1g030">desenhaTroncosEsquerda</a></code>, que recebe um obst&#225;culo, dois n&#250;meros (abcissa e ordenada do obst&#225;culo) e uma lista de obst&#225;culos e que retorna uma lista de pictures, desenha os 
troncos virados para a esquerda, os troncos que se movimentam para a esquerda.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaTroncosEsquerda" title="Tarefa6_2022li1g030">desenhaTroncosEsquerda</a></code> pode ser definida da seguinte forma:</p><pre>desenhaTroncosEsquerda o n1 n2 [] = []
desenhaTroncosEsquerda o n1 n2 (h:t) = case h of Nenhum -&gt; (desenhaTroncosEsquerda h (n1 + 1) n2 t)
                                                 Tronco | o /= Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ [color castanhoTroncoClaro (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-770)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-770)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosEsquerda h (n1 + 1) n2 t)
                                                        | o == Tronco -&gt; [color castanhoTronco (polygon [(((-800)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2)),(((-800)+(100)*(fromIntegral n1)),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),440+(-100)*(fromIntegral n2)),(((-700)+(100*(fromIntegral n1))),360+(-100)*(fromIntegral n2))])] ++ (desenhaTroncosEsquerda h (n1 + 1) n2 t)
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaJogador" class="def">desenhaJogador</a> :: Int -&gt; Int -&gt; [Picture] <a href="#v:desenhaJogador" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaJogador" title="Tarefa6_2022li1g030">desenhaJogador</a></code>, que recebe dois n&#250;meros inteiros (a abcissa e a ordenada do jogador) e que retorna uma lista de pictures, desenha o jogador no mapa. Nesta fun&#231;&#227;o, desenhamos
uma galinha que ser&#225; posicionada no mapa em fun&#231;&#227;o da abcissa e ordenada do jogador de um jogo de um world.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:desenhaJogador" title="Tarefa6_2022li1g030">desenhaJogador</a></code> pode ser definida da seguinte forma:</p><pre>desenhaJogador x y = [color yellow (polygon [(((-790)+(100*(fromIntegral x))),(360+(-100)*(fromIntegral y))),((((-790) + 100*(fromIntegral x)),(440+(-100)*(fromIntegral y)))),(((-710)+(100*(fromIntegral x))),440+(-100)*(fromIntegral y)),(((-710)+(100*(fromIntegral x))),360+(-100)*(fromIntegral y))])] ++ [color red (polygon [(((-755)+(100*(fromIntegral x))),410+(-100)*(fromIntegral y)),(((-755)+(100)*(fromIntegral x)),450+(-100)*(fromIntegral y)),(((-745)+(100*(fromIntegral x))),450+(-100)*(fromIntegral y)),(((-745)+(100*(fromIntegral x))),410+(-100)*(fromIntegral y))])] ++ [color red (polygon [(((-780)+(100*(fromIntegral x))),350+(-100)*(fromIntegral y)),(((-770)+(100)*(fromIntegral x)),390+(-100)*(fromIntegral y)),(((-730)+(100*(fromIntegral x))),390+(-100)*(fromIntegral y)),(((-720)+(100*(fromIntegral x))),350+(-100)*(fromIntegral y))])] ++ [color black (polygon [(((-790)+(100*(fromIntegral x))),420+(-100)*(fromIntegral y)),(((-790)+(100)*(fromIntegral x)),440+(-100)*(fromIntegral y)),(((-770)+(100*(fromIntegral x))),440+(-100)*(fromIntegral y)),(((-770)+(100*(fromIntegral x))),420+(-100)*(fromIntegral y))])] ++ [color black (polygon [(((-730)+(100*(fromIntegral x))),420+(-100)*(fromIntegral y)),(((-730)+(100)*(fromIntegral x)),440+(-100)*(fromIntegral y)),(((-710)+(100*(fromIntegral x))),440+(-100)*(fromIntegral y)),(((-710)+(100*(fromIntegral x))),420+(-100)*(fromIntegral y))])]
</pre></div></div><div class="top"><p class="src"><a id="v:eventoIO" class="def">eventoIO</a> :: Event -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:eventoIO" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:eventoIO" title="Tarefa6_2022li1g030">eventoIO</a></code> atribui a cada evento as rea&#231;&#245;es pretendidas, ou seja, ao pressionar das teclas direcionais e Enter, para cada estado poss&#237;vel. Devolve o resultado encapsulado no tipo IO.</p><pre>eventoIO :: Event -&gt; World -&gt; IO World
-- Menu Inicial
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuInicial NovoJogo, seed, j, la, p, s, i) = return (ModoJogo, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuInicial NovoJogo, seed, j, la, p, s, i) = return (MenuInicial Continuar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuInicial NovoJogo, seed, j, la, p, s, i) = return (MenuInicial Sair, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuInicial Continuar, seed, j, la, p, s, i) = return (MenuInicial Sair, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuInicial Continuar, seed, j, la, p, s, i) = carregaJogo (MenuInicial Continuar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuInicial Sair, seed, j, la, p, s, i) =  exitSuccess
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuInicial Sair, seed, j, la, p, s, i) = return (MenuInicial NovoJogo, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuInicial Sair, seed, j, la, p, s, i) = return (MenuInicial Continuar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuInicial Continuar, seed, j, la, p, s, i) = return (MenuInicial NovoJogo, seed, j, la, p, s, i)
-- Perdeu Jogo
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (PerdeuJogo, _, j, la, p, s, i) = do
    seed1 &lt;- randomIO
    seed2 &lt;- randomIO
    seed3 &lt;- randomIO
    seed4 &lt;- randomIO
    seed5 &lt;- randomIO
    return (estadoInicial i [seed1, seed2, seed3, seed4, seed5])
-- Modo Jogo
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (ModoJogo, seed, j, la, p, s, i) | jogoTerminou j = removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i)
                                                                        | variacaoDaOrdenada j (Move Cima) /= 0 &amp;&amp; la+1 &gt; p = return (ModoJogo, seed, animaJogador j (Move Cima), la+1, p+1, s, i)
                                                                        | variacaoDaOrdenada j (Move Cima) /= 0 &amp;&amp; la+1 &lt;= p = return (ModoJogo, seed, animaJogador j (Move Cima), la+1, p, s, i)
                                                                        | otherwise = return (ModoJogo, seed, animaJogador j (Move Cima), la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (ModoJogo, seed, j, la, p, s, i) | jogoTerminou j = removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i)
                                                                          | variacaoDaOrdenada j (Move Baixo) /= 0 = return (ModoJogo, seed, animaJogador j (Move Baixo), la-1, p, s, i) 
                                                                          | otherwise = return (ModoJogo, seed, animaJogador j (Move Baixo), la, p, s, i)
eventoIO (EventKey (SpecialKey KeyLeft) Down _ _) (ModoJogo, seed, j, la, p, s, i) = 
    if jogoTerminou j then removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i) else return (ModoJogo, seed, animaJogador j (Move Esquerda), la, p, s, i)
eventoIO (EventKey (SpecialKey KeyRight) Down _ _) (ModoJogo, seed, j, la, p, s, i) = 
    if jogoTerminou j then removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i) else return (ModoJogo, seed, animaJogador j (Move Direita), la, p, s, i)
eventoIO (EventKey (SpecialKey _) Up _ _) (ModoJogo, seed, j, la, p, s, i) = if jogoTerminou j then removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i) else return (ModoJogo, seed, animaJogador j (Parado), la, p, s, i)
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (ModoJogo, seed, j, la, p, s, i) = if jogoTerminou j then removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i) else return (MenuPausa Retomar, seed, j, la, p, s, i)
-- Menu Pausa
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuPausa Retomar, seed, j, la, p, s, i) = return (ModoJogo, seed,j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuPausa Retomar, seed, j, la, p, s, i) = return (MenuPausa Gravar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuPausa Retomar, seed, j, la, p, s, i) = return (MenuPausa VoltarMenuInicial, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuPausa Gravar, seed, j, la, p, s, i) = guardaJogo (MenuPausa Gravado, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuPausa Gravar, seed, j, la, p, s, i) = return (MenuPausa VoltarMenuInicial, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuPausa Gravar, seed, j, la, p, s, i) = return (MenuPausa Retomar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuPausa Gravado, seed, j, la, p, s, i) = return (MenuPausa VoltarMenuInicial, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuPausa Gravado, seed, j, la, p, s, i) = return (MenuPausa Retomar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyEnter) Down _ _) (MenuPausa VoltarMenuInicial, _, j, la, p, s, i) = do
    seed1 &lt;- randomIO
    seed2 &lt;- randomIO
    seed3 &lt;- randomIO
    seed4 &lt;- randomIO
    seed5 &lt;- randomIO
    return (estadoInicial i [seed1, seed2, seed3, seed4, seed5])
eventoIO (EventKey (SpecialKey KeyUp) Down _ _) (MenuPausa VoltarMenuInicial, seed, j, la, p, s, i) = return (MenuPausa Gravar, seed, j, la, p, s, i)
eventoIO (EventKey (SpecialKey KeyDown) Down _ _) (MenuPausa VoltarMenuInicial, seed, j, la, p, s, i) = return (MenuPausa Retomar, seed, j, la, p, s, i)
eventoIO _ (ModoJogo, seed, j, la, p, s, i) = if jogoTerminou j then removeJogoGuardado (PerdeuJogo, seed, j, la, p, s, i) else return (ModoJogo, seed, animaJogador j (Parado), la, p, s, i)
eventoIO _ w = return w
</pre></div></div><div class="top"><p class="src"><a id="v:tempoIO" class="def">tempoIO</a> :: Float -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:tempoIO" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:tempoIO" title="Tarefa6_2022li1g030">tempoIO</a></code> &#233; uma fun&#231;&#227;o executada a cada frame, que cria uma nova seed a cada chamada, e atribui essa seed como argumento &#224; fun&#231;&#227;o pura <code><a href="Tarefa6_2022li1g030.html#v:tempo" title="Tarefa6_2022li1g030">tempo</a></code>. Devolve o resultado encapsulado no tipo IO, de forma a cumprir o tipo estabelecido (IO World).</p><pre>tempoIO :: Float -&gt; World -&gt; IO World
tempoIO n w = do
    seed &lt;- randomIO
    return (tempo n seed w)
</pre></div></div><div class="top"><p class="src"><a id="v:tempo" class="def">tempo</a> :: Float -&gt; Int -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:tempo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:tempo" title="Tarefa6_2022li1g030">tempo</a></code>, que recebe um float (que representa os segundos passados), um n&#250;mero inteiro (um n&#250;mero ale&#225;torio) e um world e que retorna um world, &#233; a fun&#231;&#227;o que muda o world em
fun&#231;&#227;o do tempo, em fun&#231;&#227;o dos segundos que se passaram. Como o terceiro par&#226;metro da fun&#231;&#227;o playIO &#233; 1, ou seja, como o frame rate &#233; 1, isto significa que a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:tempo" title="Tarefa6_2022li1g030">tempo</a></code> ser&#225; chamada a 
cada um novo segundo, ou seja, de um em um segundo.</p><p>Assim, a cada segundo a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:tempo" title="Tarefa6_2022li1g030">tempo</a></code> verifica se o jogo terminou atrav&#233;s da fun&#231;&#227;o <code><a href="Tarefa4_2022li1g030.html#v:jogoTerminou" title="Tarefa4_2022li1g030">jogoTerminou</a></code> e se tal aconteceu retorna um world em que o EstadoAtual &#233; PerdeuJogo e em que o
TempoDecorrido aumenta um valor (passou um segundo). Se o jogo n&#227;o tiver terminado, a fun&#231;&#227;o tempo ir&#225; animar o jogo do world ou ir&#225; deslizar e animar o jogo do world. Se passou um n&#250;mero
par de segundos, ou seja, se mod td 2 &#233; igual a 0, ent&#227;o iremos apenas animar o jogo. Se passou um n&#250;mero &#237;mpar de segundos, ou seja, se mod td 2 &#233; desigual a 0, ent&#227;o iremos deslizar e
animar o jogo. Deste modo, animamos o jogo a cada um segundo e deslizamos o jogo a cada dois segundos. </p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:tempo" title="Tarefa6_2022li1g030">tempo</a></code> pode ser definida da seguinte forma:</p><pre>tempo n seed (ModoJogo, s, (Jogo (Jogador (x,y)) m), la, p, td, i) = 
    if jogoTerminou (Jogo (Jogador (x,y)) m) 
        then (PerdeuJogo, s, (Jogo (Jogador (x,y)) m), la, p, td+1, i)
        -- deslizar jogo apenas quando o tempo decorrido &#233; &#237;mpar
        else if mod td 2 == 0 
                then (ModoJogo, s, animaJogo (Jogo (Jogador (x,y)) m) Parado, la, p, td+1, i)
                else (ModoJogo, s, deslizaJogo seed (animaJogo (Jogo (Jogador (x,y)) m) Parado), la, p, td+1, i)
tempo _ _ w = w
</pre></div></div><div class="top"><p class="src"><a id="v:converteWorldParaSaveData" class="def">converteWorldParaSaveData</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a> <a href="#v:converteWorldParaSaveData" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:converteWorldParaSaveData" title="Tarefa6_2022li1g030">converteWorldParaSaveData</a></code> recebe dados do tipo <code><a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></code> e converte-os para dados do tipo <code><a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a></code> para poderem ser usados na fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:guardaJogo" title="Tarefa6_2022li1g030">guardaJogo</a></code>. No processo retira as <code><a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a></code> contidas no <code><a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></code>.</p><pre>converteWorldParaSaveData :: World -&gt; SaveData
converteWorldParaSaveData (m, seed, j, la, p, s, i) = (m, seed, j, la, p, s)
</pre></div></div><div class="top"><p class="src"><a id="v:guardaJogo" class="def">guardaJogo</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:guardaJogo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:guardaJogo" title="Tarefa6_2022li1g030">guardaJogo</a></code> escreve o conte&#250;do que recebe num ficheiro, de modo a guardar o progresso no jogo quando for chamada, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:converteWorldParaSaveData" title="Tarefa6_2022li1g030">converteWorldParaSaveData</a></code>.</p><pre>guardaJogo :: World -&gt; IO World
guardaJogo w = do 
    writeFile &quot;crossyroad.sav&quot; (show $ converteWorldParaSaveData w)
    return w
</pre></div></div><div class="top"><p class="src"><a id="v:converteSaveDataParaWorld" class="def">converteSaveDataParaWorld</a> :: <a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a> -&gt; <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:converteSaveDataParaWorld" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:converteSaveDataParaWorld" title="Tarefa6_2022li1g030">converteSaveDataParaWorld</a></code> converte dados do tipo <code><a href="Tarefa6_2022li1g030.html#t:SaveData" title="Tarefa6_2022li1g030">SaveData</a></code> para dados do tipo <code><a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></code>, devolvendo tamb&#233;m as <code><a href="Tarefa6_2022li1g030.html#t:Imagens" title="Tarefa6_2022li1g030">Imagens</a></code> que devem estar inclu&#237;das no tipo <code><a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a></code>. Esta fun&#231;&#227;o &#233; usada na fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:carregaJogo" title="Tarefa6_2022li1g030">carregaJogo</a></code>.</p><pre>converteSaveDataParaWorld :: SaveData -&gt; Imagens -&gt; World
converteSaveDataParaWorld (m, seed, j, la, p, s) i = (m, seed, j, la, p, s, i)
</pre></div></div><div class="top"><p class="src"><a id="v:carregaJogo" class="def">carregaJogo</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:carregaJogo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:carregaJogo" title="Tarefa6_2022li1g030">carregaJogo</a></code> verifica se existe algum ficheiro com o progresso de jogo guardado e, caso exista, l&#234;-o e apresenta o jogo guardado, com o aux&#237;lio da fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:converteSaveDataParaWorld" title="Tarefa6_2022li1g030">converteSaveDataParaWorld</a></code>.</p><pre>carregaJogo :: World -&gt; IO World 
carregaJogo (m, seed, j, la, p, s, i) = do
    fileExist &lt;- doesFileExist &quot;crossyroad.sav&quot;
    saved &lt;- if fileExist then readFile &quot;crossyroad.sav&quot;
                          else return (show (m, seed, j, la, p, s))
    return (converteSaveDataParaWorld (read saved) i)
</pre></div></div><div class="top"><p class="src"><a id="v:removeJogoGuardado" class="def">removeJogoGuardado</a> :: <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> -&gt; IO <a href="Tarefa6_2022li1g030.html#t:World" title="Tarefa6_2022li1g030">World</a> <a href="#v:removeJogoGuardado" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:removeJogoGuardado" title="Tarefa6_2022li1g030">removeJogoGuardado</a></code> elimina, caso exista, o ficheiro com progresso do jogo guardado, em caso de perder o jogo.</p><pre>removeJogoGuardado :: World -&gt; IO World
removeJogoGuardado w = do 
    fileExist &lt;- doesFileExist &quot;crossyroad.sav&quot;
    if fileExist then removeFile &quot;crossyroad.sav&quot;
                 else return ()
    return w
</pre></div></div><div class="top"><p class="src"><a id="v:verdeRelva" class="def">verdeRelva</a> :: Color <a href="#v:verdeRelva" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:verdeRelva" title="Tarefa6_2022li1g030">verdeRelva</a></code> ser&#225; usada para atribuir a cor <code>light green</code> a alguns elementos do jogo.</p><pre>verdeRelva :: Color
verdeRelva = light green
</pre></div></div><div class="top"><p class="src"><a id="v:cinzaEstrada" class="def">cinzaEstrada</a> :: Color <a href="#v:cinzaEstrada" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:cinzaEstrada" title="Tarefa6_2022li1g030">cinzaEstrada</a></code> ser&#225; usada para atribuir a cor <code>dark (dark (greyN 0.8))</code> a determinados elementos do jogo.</p><pre>cinzaEstrada :: Color
cinzaEstrada = dark (dark (greyN 0.8))
</pre></div></div><div class="top"><p class="src"><a id="v:azulRio" class="def">azulRio</a> :: Color <a href="#v:azulRio" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:azulRio" title="Tarefa6_2022li1g030">azulRio</a></code> ser&#225; usada para atribuir a cor <code>light azure</code> a certos elementos do jogo.</p><pre>azulRio :: Color
azulRio = light azure
</pre></div></div><div class="top"><p class="src"><a id="v:castanhoTronco" class="def">castanhoTronco</a> :: Color <a href="#v:castanhoTronco" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:castanhoTronco" title="Tarefa6_2022li1g030">castanhoTronco</a></code> ser&#225; usada para atribuir a cor personalizada <code>makeColor 0.4 0.2 0 0.9</code> a alguns elementos do jogo.</p><pre>castanhoTronco :: Color
castanhoTronco = (makeColor 0.4 0.2 0 0.9)
</pre></div></div><div class="top"><p class="src"><a id="v:castanhoTroncoClaro" class="def">castanhoTroncoClaro</a> :: Color <a href="#v:castanhoTroncoClaro" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:castanhoTroncoClaro" title="Tarefa6_2022li1g030">castanhoTroncoClaro</a></code> ser&#225; usada para atribuir a cor <code>light castanhoTronco</code>  a alguns elementos do jogo.</p><pre>castanhoTroncoClaro :: Color
castanhoTroncoClaro = light castanhoTronco
</pre></div></div><div class="top"><p class="src"><a id="v:fundo" class="def">fundo</a> :: Picture <a href="#v:fundo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:fundo" title="Tarefa6_2022li1g030">fundo</a></code> atribui a cor <code>light green</code> ao fundo da janela, atrav&#233;s da fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:verdeRelva" title="Tarefa6_2022li1g030">verdeRelva</a></code>.</p><pre>fundo :: Picture
fundo = color verdeRelva (polygon [((-800),(-450)),((-800),450),(800,450),(800,(-450))])
</pre></div></div><div class="top"><p class="src"><a id="v:fundoPerdeu" class="def">fundoPerdeu</a> :: Picture <a href="#v:fundoPerdeu" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa6_2022li1g030.html#v:fundoPerdeu" title="Tarefa6_2022li1g030">fundoPerdeu</a></code> atribui a cor <code>light (light red)</code> ao fundo do ecr&#227; do modo PerdeuJogo.</p><pre>fundoPerdeu :: Picture
fundoPerdeu = color (light red) (polygon [((-800),(-450)),((-800),450),(800,450),(800,(-450))])
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>