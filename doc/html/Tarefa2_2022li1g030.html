<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g030</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Ana S&#225; Oliveira &lt;a104437@alunos.uminho.pt&gt;<br />Sara Campos Ramalho &lt;a72481@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2_2022li1g030</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o estendeMapa</a><ul><li><a href="#g:2">Fun&#231;&#245;es principais</a></li><li><a href="#g:3">Fun&#231;&#245;es auxiliares</a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:gera">gera</a> :: Int -&gt; Int -&gt; [Int]</li><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:geraTerreno">geraTerreno</a> :: Int -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:rioAnterior">rioAnterior</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Bool</li><li class="src short"><a href="#v:velocRioAnterior">velocRioAnterior</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a></li><li class="src short"><a href="#v:geraVelocidade">geraVelocidade</a> :: Int -&gt; [<a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a>] -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a></li><li class="src short"><a href="#v:adicionaVelocidade">adicionaVelocidade</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:contaExtremos">contaExtremos</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int</li><li class="src short"><a href="#v:geraObstaculo">geraObstaculo</a> :: [Int] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:velocidade_max">velocidade_max</a> :: Int</li><li class="src short"><a href="#v:adicionaObstaculo">adicionaObstaculo</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:escolherIndice">escolherIndice</a> :: Int -&gt; [Int] -&gt; Int</li><li class="src short"><a href="#v:substituirEm">substituirEm</a> :: Int -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:eRelva">eRelva</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Bool</li><li class="src short"><a href="#v:eRio">eRio</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Bool</li><li class="src short"><a href="#v:numeroNenhum">numeroNenhum</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; Int</li><li class="src short"><a href="#v:calcProxVelPossivel">calcProxVelPossivel</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a>]</li><li class="src short"><a href="#v:proximosObstaculosRio">proximosObstaculosRio</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximosObstaculosEstrada">proximosObstaculosEstrada</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximosObstaculosRelva">proximosObstaculosRelva</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o estendeMapa</h1></a><a href="#g:2" id="g:2"><h2>Fun&#231;&#245;es principais</h2></a><div class="top"><p class="src"><a id="v:gera" class="def">gera</a> :: Int -&gt; Int -&gt; [Int] <a href="#v:gera" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:gera" title="Tarefa2_2022li1g030">gera</a></code> devolve n&#250;meros inteiros aleatoriamente, para serem utilizados em fun&#231;&#245;es posteriores de modo a criar aleatoriedade na cria&#231;&#227;o das novas linhas do mapa.</p><pre>gera seed n = take n $ randoms (mkStdGen seed)
</pre></div></div><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:estendeMapa" title="Tarefa2_2022li1g030">estendeMapa</a></code> gera e acrescenta uma nova linha v&#225;lida no topo de um dado mapa, de largura <code>n</code> e composto pela lista <code>l</code>, em que cada elemento <code>(Terreno, [Obstaculos])</code> representa uma linha do mapa.</p><p>No caso de ainda n&#227;o existir nenhuma linha no mapa, isto &#233;, l = [], a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:estendeMapa" title="Tarefa2_2022li1g030">estendeMapa</a></code> gera a primeira linha.</p><p>O argumento <code>seed</code> &#233; um inteiro aleat&#243;rio usado para acrescentar pseudo-aleatoriedade &#224; gera&#231;&#227;o da nova linha.</p><p>Esta fun&#231;&#227;o pode ser definida da seguinte forma: </p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa (Mapa n l) seed = let ptv = proximosTerrenosValidos (Mapa n l)
                                  t0 = geraTerreno seed ptv
                                  lvp = calcProxVelPossivel l t0
                                  velocidade = geraVelocidade seed lvp
                                  terreno = adicionaVelocidade t0 velocidade
                                  obstaculos = adicionaObstaculo (Mapa n l) seed terreno
                              in Mapa n ((terreno, obstaculos):l)
</pre></div></div><a href="#g:3" id="g:3"><h2>Fun&#231;&#245;es auxiliares</h2></a><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g030">proximosTerrenosValidos</a></code> devolve uma lista dos terrenos pass&#237;veis de ser utilizados numa pr&#243;xima linha do mapa, a partir de uma ou mais linhas anteriores.
Aqui podemos limitar a quantidade de terrenos cont&#237;guos de cada tipo, com um m&#225;ximo de 4 rios seguidos, e 5 estradas ou relvas seguidas.</p><p>Assim, a fun&#231;&#227;o <code>proximosTerrrenosValidos</code> pode ser definida da seguinte forma:</p><pre>proximosTerrenosValidos (Mapa _ ((Rio _, _):(Rio _, _):(Rio _, _):(Rio _, _):t)) = [Estrada 0, Relva]
proximosTerrenosValidos (Mapa _ ((Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _, _):t)) = [Rio 0, Relva]
proximosTerrenosValidos (Mapa _ ((Relva, _):(Relva, _):(Relva, _):(Relva, _):(Relva, _):t)) = [Rio 0, Estrada 0]
proximosTerrenosValidos _ = [Rio 0, Estrada 0, Relva]
</pre></div></div><div class="top"><p class="src"><a id="v:geraTerreno" class="def">geraTerreno</a> :: Int -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:geraTerreno" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraTerreno" title="Tarefa2_2022li1g030">geraTerreno</a></code> cria, com base em aleat&#243;rios devolvidos pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:gera" title="Tarefa2_2022li1g030">gera</a></code> e nas possibilidades oferecidas pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g030">proximosTerrenosValidos</a></code>, 
um terreno que ser&#225; utilizado numa pr&#243;xima linha do mapa.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraTerreno" title="Tarefa2_2022li1g030">geraTerreno</a></code> pode ser definida da seguinte forma:</p><pre>geraTerreno seed l = let rn = head (gera seed 1)
                         ri = mod rn (length l)
                     in l !! ri
</pre></div></div><div class="top"><p class="src"><a id="v:rioAnterior" class="def">rioAnterior</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Bool <a href="#v:rioAnterior" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:rioAnterior" title="Tarefa2_2022li1g030">rioAnterior</a></code> ser&#225; usada na fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:estendeMapa" title="Tarefa2_2022li1g030">estendeMapa</a></code> para verificar, no caso de a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraTerreno" title="Tarefa2_2022li1g030">geraTerreno</a></code> gerar Rio para a nova linha, se a linha pr&#233;via mais recente do mapa usa o terreno <code>Rio _</code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:rioAnterior" title="Tarefa2_2022li1g030">rioAnterior</a></code> pode ser definida da seguinte forma:</p><pre>rioAnterior ((Rio _,_):_) = True
rioAnterior _ = False
</pre></div></div><div class="top"><p class="src"><a id="v:velocRioAnterior" class="def">velocRioAnterior</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a> <a href="#v:velocRioAnterior" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:velocRioAnterior" title="Tarefa2_2022li1g030">velocRioAnterior</a></code> ser&#225; usada na fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:estendeMapa" title="Tarefa2_2022li1g030">estendeMapa</a></code> para, no caso de a fun&#231;&#227;o auxiliar <code><a href="Tarefa2_2022li1g030.html#v:rioAnterior" title="Tarefa2_2022li1g030">rioAnterior</a></code> devolver <code>True</code>, tomar a velocidade com que esse rio anterior se move. </p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:velocRioAnterior" title="Tarefa2_2022li1g030">velocRioAnterior</a></code> pode ser definida da seguinte forma:</p><pre>velocRioAnterior ((Rio v,_):_) = v
velocRioAnterior _ = 0
</pre></div></div><div class="top"><p class="src"><a id="v:geraVelocidade" class="def">geraVelocidade</a> :: Int -&gt; [<a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a>] -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a> <a href="#v:geraVelocidade" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraVelocidade" title="Tarefa2_2022li1g030">geraVelocidade</a></code> d&#225;, com base em aleat&#243;rios devolvidos pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:gera" title="Tarefa2_2022li1g030">gera</a></code>, uma velocidade que ser&#225; associada a um terreno numa pr&#243;xima linha do mapa.</p><p>No caso de a linha anterior usar um terreno <code>Rio</code> e de a <code><a href="Tarefa2_2022li1g030.html#v:geraTerreno" title="Tarefa2_2022li1g030">geraTerreno</a></code> ter atribu&#237;do igualmente um terreno <code>Rio</code> &#224; nova linha, com o aux&#237;lio das fun&#231;&#245;es <code><a href="Tarefa2_2022li1g030.html#v:rioAnterior" title="Tarefa2_2022li1g030">rioAnterior</a></code> e <code><a href="Tarefa2_2022li1g030.html#v:velocRioAnterior" title="Tarefa2_2022li1g030">velocRioAnterior</a></code>,
esta fun&#231;&#227;o ir&#225; atribuir velocidades de dire&#231;&#227;o oposta a rios cont&#237;guos.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraVelocidade" title="Tarefa2_2022li1g030">geraVelocidade</a></code> pode ser definida da seguinte forma:</p><pre>geraVelocidade seed l = let rn = head (gera seed 1)
                            ri = mod rn (length l)
                        in l !! ri
</pre></div></div><div class="top"><p class="src"><a id="v:adicionaVelocidade" class="def">adicionaVelocidade</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; <a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a> -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:adicionaVelocidade" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:adicionaVelocidade" title="Tarefa2_2022li1g030">adicionaVelocidade</a></code> associa a velocidade devolvida pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraVelocidade" title="Tarefa2_2022li1g030">geraVelocidade</a></code> ao terreno selecionado pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraTerreno" title="Tarefa2_2022li1g030">geraTerreno</a></code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:adicionaVelocidade" title="Tarefa2_2022li1g030">adicionaVelocidade</a></code> pode ser definida da seguinte forma:</p><pre>adicionaVelocidade (Rio _) v = Rio v
adicionaVelocidade (Estrada _) v = Estrada v
adicionaVelocidade Relva _ = Relva
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g030">proximosObstaculosValidos</a></code> calcula que obst&#225;culos podem ser utilizados para preencher a lista de obst&#225;culos de uma pr&#243;xima linha do mapa, conforme o terreno gerado para a nova linha.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g030">proximosObstaculosValidos</a></code> pode ser definida da seguinte forma:</p><pre>proximosObstaculosValidos n (t,l)
    | length l &gt;= n = []
    | length l == (n-1) &amp;&amp; not (elem Nenhum l) = [Nenhum]
    | length l == (n-1) = case t of
                            (Rio _) -&gt; if not (elem Tronco l) then [Tronco]
                                                              else let inicio = contaExtremos l Tronco
                                                                       fim = contaExtremos (reverse l) Tronco  
                                                                   in if inicio + fim &lt; 5 then [Nenhum, Tronco]
                                                                                          else [Nenhum]
                            (Estrada _) -&gt; let inicio = contaExtremos l Carro
                                               fim = contaExtremos (reverse l) Carro  
                                           in if inicio + fim &lt; 3 then [Nenhum, Carro]
                                                                  else [Nenhum]
                            Relva -&gt; [Nenhum, Arvore]
    | otherwise = case t of
                    (Rio _) -&gt; let inicio = contaExtremos l Tronco
                               in if inicio &lt; 5 then [Nenhum, Tronco]
                                                else [Nenhum]
                    (Estrada _) -&gt; let inicio = contaExtremos l Carro
                                   in if inicio &lt; 3 then [Nenhum, Carro]
                                                    else [Nenhum]
                    Relva -&gt; [Nenhum, Arvore]
</pre></div></div><div class="top"><p class="src"><a id="v:contaExtremos" class="def">contaExtremos</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; Int <a href="#v:contaExtremos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:contaExtremos" title="Tarefa2_2022li1g030">contaExtremos</a></code> &#233; uma fun&#231;&#227;o auxiliar da fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g030">proximosObstaculosValidos</a></code> criada para garantir que obst&#225;culos como <code>Tronco</code> e <code>Carro</code> n&#227;o ultrapassam o seu comprimento m&#225;ximo.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:contaExtremos" title="Tarefa2_2022li1g030">contaExtremos</a></code> pode ser definida da seguinte forma:</p><pre>contaExtremos [] _ = 0
contaExtremos (h:t) o = if h == o then 1 + contaExtremos t o 
                                  else 0
</pre></div></div><div class="top"><p class="src"><a id="v:geraObstaculo" class="def">geraObstaculo</a> :: [Int] -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:geraObstaculo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:geraObstaculo" title="Tarefa2_2022li1g030">geraObstaculo</a></code> d&#225;, com base em aleat&#243;rios devolvidos pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:gera" title="Tarefa2_2022li1g030">gera</a></code> e na lista de possibilidades criada pela fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g030">proximosObstaculosValidos</a></code>, 
uma lista de obst&#225;culos que ser&#225; usada numa pr&#243;xima linha do mapa. </p><p>Assim, a fun&#231;&#227;o <code>geraObstaculos</code> pode ser definida da seguinte forma:</p><pre>geraObstaculo [] _ _ = []
geraObstaculo (r:rs) n (t,lo)
    | length lo == n = []
    | otherwise = let pov = proximosObstaculosValidos n (t,lo)
                      po = mod r (length pov)
                  in (pov !! po) : geraObstaculo rs n (t,(pov !! po):lo)
</pre></div></div><div class="top"><p class="src"><a id="v:velocidade_max" class="def">velocidade_max</a> :: Int <a href="#v:velocidade_max" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:velocidade_max" title="Tarefa2_2022li1g030">velocidade_max</a></code> atribui uma velocidade m&#225;xima que ser&#225; utilizada no movimento dos obst&#225;culos.</p><pre>velocidade_max :: Int
velocidade_max = 3
</pre></div></div><div class="top"><p class="src"><a id="v:adicionaObstaculo" class="def">adicionaObstaculo</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:adicionaObstaculo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:adicionaObstaculo" title="Tarefa2_2022li1g030">adicionaObstaculo</a></code>, que recebe um mapa, uma seed e um terreno e que retorna uma lista de obst&#225;culos, para al&#233;m de criar uma lista de obst&#225;culos que ser&#225; usada na nova linha do mapa, tamb&#233;m permite que exista um caminho poss&#237;vel para o jogador percorrer no caso de terrenos de <code>Relva</code> cont&#237;guos, colocando obrigatoriamente <code>Nenhum</code> &#224; frente de um <code>Nenhum</code> da linha anterior escolhido aleatoriamente. </p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:adicionaObstaculo" title="Tarefa2_2022li1g030">adicionaObstaculo</a></code> pode ser definida da seguinte forma:</p><pre>adicionaObstaculo (Mapa n ((t,lo):_)) seed terreno = let lobst = geraObstaculo (gera seed n) n (terreno, [])
                                                     in if eRelva terreno &amp;&amp; eRelva t then substituirEm (escolherIndice seed (elemIndices Nenhum lo)) Nenhum lobst
                                                                                      else lobst
</pre></div></div><div class="top"><p class="src"><a id="v:escolherIndice" class="def">escolherIndice</a> :: Int -&gt; [Int] -&gt; Int <a href="#v:escolherIndice" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:escolherIndice" title="Tarefa2_2022li1g030">escolherIndice</a></code>, que recebe uma seed e uma lista e que retorna um n&#250;mero inteiro, seleciona aleatoriamente um &#237;ndice de uma lista, que ser&#225; usado na fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:adicionaObstaculo" title="Tarefa2_2022li1g030">adicionaObstaculo</a></code> para colocar um obst&#225;culo do tipo <code>Nenhum</code> nessa posi&#231;&#227;o correspondente na lista de obst&#225;culos.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:escolherIndice" title="Tarefa2_2022li1g030">escolherIndice</a></code> pode ser definida da seguinte forma:</p><pre>escolherIndice seed l = let rn = head (gera seed 1)
                            ri = mod rn (length l)
                        in l !! ri
</pre></div></div><div class="top"><p class="src"><a id="v:substituirEm" class="def">substituirEm</a> :: Int -&gt; <a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a> -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:substituirEm" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:substituirEm" title="Tarefa2_2022li1g030">substituirEm</a></code>, que recebe um n&#250;mero inteiro (abcissa), um obst&#225;culo e uma lista de obst&#225;culos e retorna uma lista de obst&#225;culos, vai permitir colocar um obst&#225;culo &#224; escolha no lugar de outro numa lista de obst&#225;culos.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:substituirEm" title="Tarefa2_2022li1g030">substituirEm</a></code> pode ser definida da seguinte forma:</p><pre>substituirEm x obst [] = []
substituirEm 0 obst (h:t) = obst:t
substituirEm x obst (h:t) = h:(substituirEm (x-1) obst t)
</pre></div></div><div class="top"><p class="src"><a id="v:eRelva" class="def">eRelva</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Bool <a href="#v:eRelva" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:eRelva" title="Tarefa2_2022li1g030">eRelva</a></code>, que recebe um terreno e retorna um bool, verifica se um terreno &#233; do tipo <code>Relva</code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:eRelva" title="Tarefa2_2022li1g030">eRelva</a></code> pode ser definida da seguinte forma:</p><pre>eRelva Relva = True
eRelva _ = False
</pre></div></div><div class="top"><p class="src"><a id="v:eRio" class="def">eRio</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Bool <a href="#v:eRio" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:eRio" title="Tarefa2_2022li1g030">eRio</a></code>, que recebe um terreno e retorna um bool,verifica se um terreno &#233; do tipo <code>Rio</code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:eRio" title="Tarefa2_2022li1g030">eRio</a></code> pode ser definida da seguinte forma:</p><pre>eRio (Rio _) = True
eRio _ = False
</pre></div></div><div class="top"><p class="src"><a id="v:numeroNenhum" class="def">numeroNenhum</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; Int <a href="#v:numeroNenhum" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:numeroNenhum" title="Tarefa2_2022li1g030">numeroNenhum</a></code>, que recebe uma lista de obst&#225;culos e retorna um n&#250;mero inteiro, calcula o n&#250;mero de obst&#225;culos do tipo <code>Nenhum</code> numa lista de obst&#225;culos.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:numeroNenhum" title="Tarefa2_2022li1g030">numeroNenhum</a></code> pode ser definida da seguinte forma:</p><pre>numeroNenhum [] = 0
numeroNenhum (h:t) | h == Nenhum = 1 + numeroNenhum t
                   | otherwise = numeroNenhum t
</pre></div></div><div class="top"><p class="src"><a id="v:calcProxVelPossivel" class="def">calcProxVelPossivel</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; [<a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a>] <a href="#v:calcProxVelPossivel" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:calcProxVelPossivel" title="Tarefa2_2022li1g030">calcProxVelPossivel</a></code>, que recebe uma lista de pares de terreno e de lista de obst&#225;culos e um terreno e que retorna uma lista de velocidades, vai calcular as possibilidades pass&#237;veis de serem usadas para a velocidade do pr&#243;ximo terreno.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:calcProxVelPossivel" title="Tarefa2_2022li1g030">calcProxVelPossivel</a></code> pode ser definida da seguinte forma:</p><pre>calcProxVelPossivel l t0 = let va = if eRio t0 &amp;&amp; rioAnterior l then velocRioAnterior l
                                                                else 0
                               lvp = if va &lt; 0 then [1..velocidade_max]
                                               else if va &gt; 0 then [(-velocidade_max)..(-1)]
                                                              else [(-velocidade_max)..(-1)] ++ [1..velocidade_max]
                           in lvp
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosRio" class="def">proximosObstaculosRio</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosRio" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosRio" title="Tarefa2_2022li1g030">proximosObstaculosRio</a></code>, que recebe e retorna uma lista de obst&#225;culos, define os pr&#243;ximos obst&#225;culos que podem ser usados num terreno do tipo <code>Rio</code>, tendo em aten&#231;&#227;o o comprimento m&#225;ximo dos obst&#225;culos do tipo <code>Tronco</code>, que deve ser 5.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosRio" title="Tarefa2_2022li1g030">proximosObstaculosRio</a></code> pode ser definida da seguinte forma:</p><pre>proximosObstaculosRio l = if not (elem Tronco l) then [Tronco]
                                                 else let inicio = contaExtremos l Tronco
                                                          fim = contaExtremos (reverse l) Tronco  
                                                      in if inicio + fim &lt; 5 then [Nenhum, Tronco]
                                                                             else [Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosEstrada" class="def">proximosObstaculosEstrada</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosEstrada" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosEstrada" title="Tarefa2_2022li1g030">proximosObstaculosEstrada</a></code>, que recebe e retorna uma lista de obst&#225;culos, define os pr&#243;ximos obst&#225;culos que podem ser usados num terreno do tipo <code>Estrada</code>, tendo em aten&#231;&#227;o o comprimento m&#225;ximo dos obst&#225;culos do tipo <code>Carro</code>, que deve ser 3.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosEstrada" title="Tarefa2_2022li1g030">proximosObstaculosEstrada</a></code> pode ser definida da seguinte forma:</p><pre>proximosObstaculosEstrada l = if not (elem Carro l) then [Carro]
                                                    else let inicio = contaExtremos l Carro
                                                             fim = contaExtremos (reverse l) Carro  
                                                         in if inicio + fim &lt; 3 then [Nenhum, Carro]
                                                                                 else [Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosRelva" class="def">proximosObstaculosRelva</a> :: [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosRelva" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosRelva" title="Tarefa2_2022li1g030">proximosObstaculosRelva</a></code>, que recebe e retorna uma lista de obst&#225;culos, define os pr&#243;ximos obst&#225;culos que podem ser usados num terreno do tipo <code>Relva</code>.</p><p>Assim, a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g030.html#v:proximosObstaculosRelva" title="Tarefa2_2022li1g030">proximosObstaculosRelva</a></code> pode ser definida da seguinte forma:</p><pre>proximosObstaculosRelva l = [Nenhum, Arvore]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>